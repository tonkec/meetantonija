<section class="contact-section">
  <div class="container">
    <div class="row">
      <div class="col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 text-center">
        <h2 class="has-text-weight-semibold	">Say hi!</h2>
      </div>
    </div>

    <div class="row">
      <div class="col-xs-12 col-md-8 offset-md-2 col-lg-6 offset-lg-3">
        <form id="form" method="post">
        <div class="row">
          <div class="col-xs-12 col-sm-6">
            <div class="field">
              <div class="control">
                <input type="text" required  name="from_name" placeholder="Your Name">
              </div>
            </div>
          </div>
          <div class="col-xs-12 col-sm-6">
            <div class="field">
              <div class="control">
                <input type="text" name="from_email" required placeholder="Your Email" pattern="[a-zA-Z0-9.!#$%&amp;â€™*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)+">
              </div>
            </div>
          </div>
          <div class="col-12">
            <div class="field">
              <div class="control">
                <textarea name="message_html"rows="5" placeholder="Message" required></textarea>
                <button class="button float-right" type="submit">Send</button>
              </div>
            </div>
          </div>
        </div>
        <div class="msg"></div>
        </form>
      </div>
    </div>
  </div>
</section>

<script>
  $("#form").on("submit", function(event) {

    event.preventDefault(); // prevent reload
    $(".msg").show();
    $(".msg").append(`
      <span class="text">Sending...</span> <span class="float-right x">X</span>
    `)
    var formData = new FormData(this);
    formData.append('service_id', 'gmail');
    formData.append('template_id', 'template_4cXwGrgd');
    formData.append('user_id', 'user_LOSuz8pR7cowgxlm0LOa5');

    $.ajax('https://api.emailjs.com/api/v1.0/email/send-form', {
        type: 'POST',
        data: formData,
        contentType: false, // auto-detection
        processData: false // no need to parse formData to string
    }).done(function() {
        $(".text").replaceWith(`
          Message Sent! I will get back to you soon :D
        `)
        $(".x").click(() => {$(".msg").remove()})
    }).fail(function(error) {
        console.log('Oops... ' + JSON.stringify(error));
    });
});
</script>
